---

- id: 60aeed61-6ea9-4dbb-afe5-2c674820de35
  name: Search and Stage Tensorflow model files
  description: Searches for Tensorflow directories and checkpoint files, and then stages
  tactic: collection
  technique:
    attack_id: T1119
    name: Automated Collection
  platforms:
    linux:
      darwin:
        sh:
          command: chmod +x ./tensorflow_file_search.sh; zsh ./tensorflow_file_search.sh '#{linux.staging.location}'
          timeout: 300
          payloads:
            - tensorflow_file_search.zsh
          cleanup:
            - if [ -d '#{linux.staging.location}' ]; then rm -rf '#{linux.staging.location}/.s'; fi;
          parsers:
            plugins.stockpile.app.parsers.basic:
              - source: host.dir.staged