- id: 1977bbf0-7a03-4c48-8c2b-48f466d84876
  name: Generate Registry Artifact For Application Using Webcam (Generated from Atomic Red Team)
  description: |
    Ability for Video Capture (ATT&CK T1125).
    Generates registry artifact for process using webcam. Reference - https://svch0st.medium.com/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072
    Generated from Atomic Red Team procedures (6581e4a7-42e3-43c5-a0d2-5a0d62f9702a); review and test safely before use.
  tactic: collection
  technique:
    attack_id: T1125
    name: Video Capture
  platforms:
    windows:
      cmd:
        command: |
          reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam\NonPackaged\C:#Windows#Temp#atomic.exe /v LastUsedTimeStart /t REG_BINARY /d a273b6f07104d601 /f &&
          reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam\NonPackaged\C:#Windows#Temp#atomic.exe /v LastUsedTimeStop /t REG_BINARY /d 96ef514b7204d601 /f
        cleanup: |
          reg DELETE HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam\NonPackaged\C:#Windows#Temp#atomic.exe /f
