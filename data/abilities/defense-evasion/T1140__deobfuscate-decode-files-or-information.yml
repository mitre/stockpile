- id: 797e6eec-e2a5-4a97-8cdd-ca5104df48c6
  name: Deobfuscate/Decode Files or Information
  description: Ability for Deobfuscate/Decode Files or Information (ATT&CK T1140).
    Generated from Atomic Red Team procedures; review and test safely before use.
  tactic: defense-evasion
  technique:
    attack_id: T1140
    name: Deobfuscate/Decode Files or Information
  platforms:
    windows:
      psh:
        command: 'certutil -encode #{executable} %temp%\T1140_calc.txt certutil -decode
          %temp%\T1140_calc.txt %temp%\T1140_calc_decoded.exe'
    linux:
      sh:
        command: 'ENCODED=$(python3 -c ''import base64;enc=base64.b64encode("#{message}".encode());print(enc.decode())'')
          python3 -c "import base64;dec=base64.b64decode(\"$ENCODED\");print(dec.decode())"
          python3 -c "import base64 as d;dec=d.b64decode(\"$ENCODED\");print(dec.decode())"
          python3 -c "from base64 import b64decode;dec=b64decode(\"$ENCODED\");print(dec.decode())"
          python3 -c "from base64 import b64decode as d;dec=d(\"$ENCODED\");print(dec.decode())"
          echo $ENCODED | python3 -c "import base64,sys;dec=base64.b64decode(sys.stdin.read());print(dec.decode())"
          echo $ENCODED > #{encoded_file} && python3 -c "import base64;dec=base64.b64decode(open(''#{encoded_file}'').read());print(dec.decode())"'
    darwin:
      sh:
        command: 'ENCODED=$(python3 -c ''import base64;enc=base64.b64encode("#{message}".encode());print(enc.decode())'')
          python3 -c "import base64;dec=base64.b64decode(\"$ENCODED\");print(dec.decode())"
          python3 -c "import base64 as d;dec=d.b64decode(\"$ENCODED\");print(dec.decode())"
          python3 -c "from base64 import b64decode;dec=b64decode(\"$ENCODED\");print(dec.decode())"
          python3 -c "from base64 import b64decode as d;dec=d(\"$ENCODED\");print(dec.decode())"
          echo $ENCODED | python3 -c "import base64,sys;dec=base64.b64decode(sys.stdin.read());print(dec.decode())"
          echo $ENCODED > #{encoded_file} && python3 -c "import base64;dec=base64.b64decode(open(''#{encoded_file}'').read());print(dec.decode())"'
