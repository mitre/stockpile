- id: 05cde730-2881-4cd5-a68c-7843db27a3d7
  name: Boot or Logon Initialization Scripts
  description: Ability for Boot or Logon Initialization Scripts (ATT&CK T1037). Generated
    from Atomic Red Team procedures; review and test safely before use.
  tactic: persistence
  technique:
    attack_id: T1037
    name: Boot or Logon Initialization Scripts
  platforms:
    windows:
      psh:
        command: 'echo "#{script_command}" > #{script_path} REG.exe ADD HKCU\Environment
          /v UserInitMprLogonScript /t REG_SZ /d "#{script_path}" /f'
    linux:
      sh:
        command: filename='/etc/rc.common';if [ ! -f $filename ];then sudo touch $filename;else
          sudo cp $filename /etc/rc.common.original;fi printf '%s\n' '#!/bin/bash'
          | sudo tee /etc/rc.common echo "python3 -c \"import os, base64;exec(base64.b64decode('aW1wb3J0IG9zCm9zLnBvcGVuKCdlY2hvIGF0b21pYyB0ZXN0IGZvciBtb2RpZnlpbmcgcmMuY29tbW9uID4gL3RtcC9UMTAzNy4wMDQucmMuY29tbW9uJykK'))\""
          | sudo tee -a /etc/rc.common printf '%s\n' 'exit 0' | sudo tee -a /etc/rc.common
          sudo chmod +x /etc/rc.common
    darwin:
      sh:
        command: sudo touch /Library/StartupItems/EvilStartup.plist
