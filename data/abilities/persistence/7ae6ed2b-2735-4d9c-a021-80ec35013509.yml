- id: 7ae6ed2b-2735-4d9c-a021-80ec35013509
  name: UEFI Persistence via Wpbbin.exe File Creation (Generated from Atomic Red Team)
  description: |
    Ability for Pre-OS Boot: System Firmware (ATT&CK T1542.001).
    Creates Wpbbin.exe in %systemroot%. This technique can be used for UEFI-based pre-OS boot persistence mechanisms.
    Ref: https://grzegorztworek.medium.com/using-uefi-to-inject-executable-files-into-bitlocker-protected-drives-8ff4ca59c94c
    Ref: http://download.microsoft.com/download/8/a/2/8a2fb72d-9b96-4e2d-a559-4a27cf905a80/windows-platform-binary-table.docx
    Ref: https://github.com/tandasat/WPBT-Builder
    Generated from Atomic Red Team procedures (b8a49f03-e3c4-40f2-b7bb-9e8f8fdddbf1); review and test safely before use.
  tactic: persistence
  technique:
    attack_id: T1542.001
    name: 'Pre-OS Boot: System Firmware'
  platforms:
    windows:
      psh:
        command: |
          echo "Creating %systemroot%\wpbbin.exe";
          New-Item -ItemType File -Path "$env:SystemRoot\System32\wpbbin.exe"
        cleanup: |
          echo "Removing %systemroot%\wpbbin.exe";
          Remove-Item -Path "$env:SystemRoot\System32\wpbbin.exe"
  privilege: Elevated
